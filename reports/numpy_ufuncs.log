Traceback (most recent call last):
  File "/home/brad/miniconda3/envs/pycourse/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/home/brad/miniconda3/envs/pycourse/lib/python3.8/site-packages/nbclient/client.py", line 1077, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/brad/miniconda3/envs/pycourse/lib/python3.8/site-packages/nbclient/util.py", line 74, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/home/brad/miniconda3/envs/pycourse/lib/python3.8/site-packages/nbclient/util.py", line 53, in just_run
    return loop.run_until_complete(coro)
  File "/home/brad/miniconda3/envs/pycourse/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/home/brad/miniconda3/envs/pycourse/lib/python3.8/site-packages/nbclient/client.py", line 526, in async_execute
    await self.async_execute_cell(
  File "/home/brad/miniconda3/envs/pycourse/lib/python3.8/site-packages/nbclient/client.py", line 822, in async_execute_cell
    self._check_raise_for_error(cell, exec_reply)
  File "/home/brad/miniconda3/envs/pycourse/lib/python3.8/site-packages/nbclient/client.py", line 730, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply['content'])
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# precompile
z = numba_add_cuda(x, y)

start = time.time()
z = numba_add(x, y)
end = time.time()
print("time for numba add: {:0.3e} sec".format(end - start))

start = time.time()
z = numba_add_vectorize(x, y)
end = time.time()
print("time for numba add (vectorized): {:0.3e} sec".format(end - start))

start = time.time()
z = numba_add_cuda(x, y)
end = time.time()
print("time for numba add (cuda): {:0.3e} sec".format(end - start))
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mCudaAPIError[0m                              Traceback (most recent call last)
[0;32m~/miniconda3/envs/pycourse/lib/python3.8/site-packages/numba/cuda/cudadrv/driver.py[0m in [0;36minitialize[0;34m(self)[0m
[1;32m    238[0m             [0m_logger[0m[0;34m.[0m[0minfo[0m[0;34m([0m[0;34m'init'[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 239[0;31m             [0mself[0m[0;34m.[0m[0mcuInit[0m[0;34m([0m[0;36m0[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    240[0m         [0;32mexcept[0m [0mCudaAPIError[0m [0;32mas[0m [0me[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/miniconda3/envs/pycourse/lib/python3.8/site-packages/numba/cuda/cudadrv/driver.py[0m in [0;36msafe_cuda_api_call[0;34m(*args)[0m
[1;32m    301[0m             [0mretcode[0m [0;34m=[0m [0mlibfn[0m[0;34m([0m[0;34m*[0m[0margs[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 302[0;31m             [0mself[0m[0;34m.[0m[0m_check_error[0m[0;34m([0m[0mfname[0m[0;34m,[0m [0mretcode[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    303[0m         [0;32mreturn[0m [0msafe_cuda_api_call[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/miniconda3/envs/pycourse/lib/python3.8/site-packages/numba/cuda/cudadrv/driver.py[0m in [0;36m_check_error[0;34m(self, fname, retcode)[0m
[1;32m    336[0m                     [0;32mraise[0m [0mCudaDriverError[0m[0;34m([0m[0;34m"CUDA initialized before forking"[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 337[0;31m             [0;32mraise[0m [0mCudaAPIError[0m[0;34m([0m[0mretcode[0m[0;34m,[0m [0mmsg[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    338[0m [0;34m[0m[0m

[0;31mCudaAPIError[0m: [999] Call to cuInit results in CUDA_ERROR_UNKNOWN

During handling of the above exception, another exception occurred:

[0;31mCudaSupportError[0m                          Traceback (most recent call last)
[0;32m<ipython-input-20-eb0c68621d6d>[0m in [0;36m<module>[0;34m[0m
[1;32m      1[0m [0;31m# precompile[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0;32m----> 2[0;31m [0mz[0m [0;34m=[0m [0mnumba_add_cuda[0m[0;34m([0m[0mx[0m[0;34m,[0m [0my[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m      3[0m [0;34m[0m[0m
[1;32m      4[0m [0mstart[0m [0;34m=[0m [0mtime[0m[0;34m.[0m[0mtime[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m      5[0m [0mz[0m [0;34m=[0m [0mnumba_add[0m[0;34m([0m[0mx[0m[0;34m,[0m [0my[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/miniconda3/envs/pycourse/lib/python3.8/site-packages/numba/cuda/dispatcher.py[0m in [0;36m__call__[0;34m(self, *args, **kws)[0m
[1;32m     39[0m                       [0mthe[0m [0minput[0m [0marguments[0m[0;34m.[0m[0;34m[0m[0;34m[0m[0m
[1;32m     40[0m         """
[0;32m---> 41[0;31m         [0;32mreturn[0m [0mCUDAUFuncMechanism[0m[0;34m.[0m[0mcall[0m[0;34m([0m[0mself[0m[0;34m.[0m[0mfunctions[0m[0;34m,[0m [0margs[0m[0;34m,[0m [0mkws[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     42[0m [0;34m[0m[0m
[1;32m     43[0m     [0;32mdef[0m [0mreduce[0m[0;34m([0m[0mself[0m[0;34m,[0m [0marg[0m[0;34m,[0m [0mstream[0m[0;34m=[0m[0;36m0[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/miniconda3/envs/pycourse/lib/python3.8/site-packages/numba/np/ufunc/deviceufunc.py[0m in [0;36mcall[0;34m(cls, typemap, args, kws)[0m
[1;32m    289[0m                 [0many_device[0m [0;34m=[0m [0;32mTrue[0m[0;34m[0m[0;34m[0m[0m
[1;32m    290[0m             [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 291[0;31m                 [0mdev_a[0m [0;34m=[0m [0mcr[0m[0;34m.[0m[0mto_device[0m[0;34m([0m[0ma[0m[0;34m,[0m [0mstream[0m[0;34m=[0m[0mstream[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    292[0m                 [0mdevarys[0m[0;34m.[0m[0mappend[0m[0;34m([0m[0mdev_a[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    293[0m [0;34m[0m[0m

[0;32m~/miniconda3/envs/pycourse/lib/python3.8/site-packages/numba/cuda/dispatcher.py[0m in [0;36mto_device[0;34m(self, hostary, stream)[0m
[1;32m    159[0m [0;34m[0m[0m
[1;32m    160[0m     [0;32mdef[0m [0mto_device[0m[0;34m([0m[0mself[0m[0;34m,[0m [0mhostary[0m[0;34m,[0m [0mstream[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 161[0;31m         [0;32mreturn[0m [0mcuda[0m[0;34m.[0m[0mto_device[0m[0;34m([0m[0mhostary[0m[0;34m,[0m [0mstream[0m[0;34m=[0m[0mstream[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    162[0m [0;34m[0m[0m
[1;32m    163[0m     [0;32mdef[0m [0mto_host[0m[0;34m([0m[0mself[0m[0;34m,[0m [0mdevary[0m[0;34m,[0m [0mstream[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/miniconda3/envs/pycourse/lib/python3.8/site-packages/numba/cuda/cudadrv/devices.py[0m in [0;36m_require_cuda_context[0;34m(*args, **kws)[0m
[1;32m    221[0m     [0;34m@[0m[0mfunctools[0m[0;34m.[0m[0mwraps[0m[0;34m([0m[0mfn[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    222[0m     [0;32mdef[0m [0m_require_cuda_context[0m[0;34m([0m[0;34m*[0m[0margs[0m[0;34m,[0m [0;34m**[0m[0mkws[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 223[0;31m         [0;32mwith[0m [0m_runtime[0m[0;34m.[0m[0mensure_context[0m[0;34m([0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    224[0m             [0;32mreturn[0m [0mfn[0m[0;34m([0m[0;34m*[0m[0margs[0m[0;34m,[0m [0;34m**[0m[0mkws[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    225[0m [0;34m[0m[0m

[0;32m~/miniconda3/envs/pycourse/lib/python3.8/contextlib.py[0m in [0;36m__enter__[0;34m(self)[0m
[1;32m    111[0m         [0;32mdel[0m [0mself[0m[0;34m.[0m[0margs[0m[0;34m,[0m [0mself[0m[0;34m.[0m[0mkwds[0m[0;34m,[0m [0mself[0m[0;34m.[0m[0mfunc[0m[0;34m[0m[0;34m[0m[0m
[1;32m    112[0m         [0;32mtry[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 113[0;31m             [0;32mreturn[0m [0mnext[0m[0;34m([0m[0mself[0m[0;34m.[0m[0mgen[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    114[0m         [0;32mexcept[0m [0mStopIteration[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    115[0m             [0;32mraise[0m [0mRuntimeError[0m[0;34m([0m[0;34m"generator didn't yield"[0m[0;34m)[0m [0;32mfrom[0m [0;32mNone[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/miniconda3/envs/pycourse/lib/python3.8/site-packages/numba/cuda/cudadrv/devices.py[0m in [0;36mensure_context[0;34m(self)[0m
[1;32m    119[0m         [0many[0m [0mtop[0m[0;34m-[0m[0mlevel[0m [0mNumba[0m [0mCUDA[0m [0mAPI[0m[0;34m.[0m[0;34m[0m[0;34m[0m[0m
[1;32m    120[0m         """
[0;32m--> 121[0;31m         [0;32mwith[0m [0mdriver[0m[0;34m.[0m[0mget_active_context[0m[0;34m([0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    122[0m             [0moldctx[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0m_get_attached_context[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    123[0m             [0mnewctx[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0mget_or_create_context[0m[0;34m([0m[0;32mNone[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/miniconda3/envs/pycourse/lib/python3.8/site-packages/numba/cuda/cudadrv/driver.py[0m in [0;36m__enter__[0;34m(self)[0m
[1;32m    393[0m         [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    394[0m             [0mhctx[0m [0;34m=[0m [0mdrvapi[0m[0;34m.[0m[0mcu_context[0m[0;34m([0m[0;36m0[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 395[0;31m             [0mdriver[0m[0;34m.[0m[0mcuCtxGetCurrent[0m[0;34m([0m[0mbyref[0m[0;34m([0m[0mhctx[0m[0;34m)[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    396[0m             [0mhctx[0m [0;34m=[0m [0mhctx[0m [0;32mif[0m [0mhctx[0m[0;34m.[0m[0mvalue[0m [0;32melse[0m [0;32mNone[0m[0;34m[0m[0;34m[0m[0m
[1;32m    397[0m [0;34m[0m[0m

[0;32m~/miniconda3/envs/pycourse/lib/python3.8/site-packages/numba/cuda/cudadrv/driver.py[0m in [0;36m__getattr__[0;34m(self, fname)[0m
[1;32m    280[0m         [0;31m# Initialize driver[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m    281[0m         [0;32mif[0m [0;32mnot[0m [0mself[0m[0;34m.[0m[0mis_initialized[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 282[0;31m             [0mself[0m[0;34m.[0m[0minitialize[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    283[0m [0;34m[0m[0m
[1;32m    284[0m         [0;32mif[0m [0mself[0m[0;34m.[0m[0minitialization_error[0m [0;32mis[0m [0;32mnot[0m [0;32mNone[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/miniconda3/envs/pycourse/lib/python3.8/site-packages/numba/cuda/cudadrv/driver.py[0m in [0;36minitialize[0;34m(self)[0m
[1;32m    240[0m         [0;32mexcept[0m [0mCudaAPIError[0m [0;32mas[0m [0me[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    241[0m             [0mself[0m[0;34m.[0m[0minitialization_error[0m [0;34m=[0m [0me[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 242[0;31m             [0;32mraise[0m [0mCudaSupportError[0m[0;34m([0m[0;34m"Error at driver init: \n%s:"[0m [0;34m%[0m [0me[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    243[0m         [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    244[0m             [0mself[0m[0;34m.[0m[0mpid[0m [0;34m=[0m [0m_getpid[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;31mCudaSupportError[0m: Error at driver init: 
[999] Call to cuInit results in CUDA_ERROR_UNKNOWN:
CudaSupportError: Error at driver init: 
[999] Call to cuInit results in CUDA_ERROR_UNKNOWN:

